<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.stylefeng.guns.rest.common.persistence.dao.MoocOrderTMapper">

    <!-- 通用查询映射结果 -->
    <resultMap id="BaseResultMap" type="com.stylefeng.guns.rest.common.persistence.model.MoocOrderT">
        <result column="UUID" property="uuid" />
        <result column="cinema_id" property="cinemaId" />
        <result column="field_id" property="fieldId" />
        <result column="film_id" property="filmId" />
        <result column="seats_ids" property="seatsIds" />
        <result column="seats_name" property="seatsName" />
        <result column="film_price" property="filmPrice" />
        <result column="order_price" property="orderPrice" />
        <result column="order_time" property="orderTime" />
        <result column="order_user" property="orderUser" />
        <result column="order_status" property="orderStatus" />
    </resultMap>
    <select id="selectOrdersByUsername" resultType="com.stylefeng.guns.rest.order.bean.OrderInfoVO">
      select ot.UUID as orderId,ft.film_name as filmName, fit.begin_time as fieldTime
      , ct.cinema_name as cinemaName,ot.seats_name as seatsName,ot.order_price as orderPrice
      , ot.order_status as orderStatus
      from mtime_user_t ut RIGHT JOIN mooc_order_t ot on ut.UUID = ot.order_user
      RIGHT JOIN mtime_film_t ft on ot.film_id = ft.film_name
      RIGHT JOIN mtime_field_t fit on ot.field_id = fit.UUID
      RIGHT JOIN mtime_cinema_t ct on ct.UUID = ot.cinema_id
      where ut.user_name = #{username}
    </select>

</mapper>
