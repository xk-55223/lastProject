<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.stylefeng.guns.rest.common.persistence.dao.FilmMapper">

    <!-- 通用查询映射结果 -->
    <resultMap id="BannerMap" type="com.stylefeng.guns.rest.film.vo.BannerVo">
        <id column="UUID" property="bannerId" />
        <result column="banner_address" property="bannerAddress" />
        <result column="banner_url" property="bannerUrl" />
    </resultMap>
    <select id="selectAllBanner" resultMap="BannerMap">
        SELECT UUID,banner_url,banner_address FROM `mtime_banner_t`
    </select>

    <resultMap id="FilmInfoMap" type="com.stylefeng.guns.rest.film.vo.FilmInfo">
        <id column="UUID" property="filmId" />
        <result column="film_type" property="filmType" />
        <result column="img_address" property="imgAddress" />
        <result column="film_name" property="filmName" />
        <result column="film_score" property="filmScore" />
        <result column="film_score" property="score" />
        <result column="film_preSaleNum" property="expectNum" />
        <result column="film_time" property="showTime" />
        <result column="film_box_office" property="boxNum" />
    </resultMap>
    <select id="selectBoxRanking" resultMap="FilmInfoMap">
        SELECT UUID,film_box_office,film_preSaleNum,film_name,film_time,film_score,film_type,img_address FROM `mtime_film_t` ORDER BY film_box_office DESC
    </select>

    <select id="selectexceptRocking" resultMap="FilmInfoMap">
        SELECT UUID,film_box_office,film_preSaleNum,film_name,film_time,film_score,film_type,img_address FROM `mtime_film_t` ORDER BY film_preSaleNum DESC
    </select>

    <select id="selectTop100" resultMap="FilmInfoMap">
        SELECT UUID,film_box_office,film_preSaleNum,film_name,film_time,film_score,film_type,img_address FROM `mtime_film_t` ORDER BY film_score DESC
        </select>

    <select id="selectFilmInfoByStatus" resultMap="FilmInfoMap">
        SELECT UUID,film_box_office,film_preSaleNum,film_name,film_time,film_score,film_type,img_address FROM `mtime_film_t` where film_status = #{id}
    </select>

    <select id="countFilmStatus" resultType="java.lang.Integer">
        SELECT COUNT(UUID) from mtime_film_t WHERE film_status = #{id}
    </select>

    <resultMap id="catInfo" type="com.stylefeng.guns.rest.film.vo.CatInfoVo">
        <id property="catId" column="UUID"/>
        <result property="catName" column="show_name"/>
    </resultMap>
    <select id="selectcatInfo" resultMap="catInfo">
        SELECT UUID,show_name FROM `mtime_cat_dict_t`
    </select>

    <select id="getFilmsList" resultType="com.stylefeng.guns.rest.film.vo.FilmInfo" >
         SELECT UUID as filmId,film_name as filmName
         ,film_score as filmScore,film_type as filmType
         ,img_address as imgAddress FROM `mtime_film_t`
          <where>
              <if test="res.cat != '#99#'">
                  and film_cats like '%#{res.cat}%'
              </if>
              <if test="res.yearId!=99">
                  and film_date = #{res.yearId}
              </if>
              <if test="res.sourceId!=99">
                  and film_source = #{res.sourceId}
              </if>
          </where>
         order by #{res.s} desc

    </select>


</mapper>
